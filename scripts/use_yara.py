import yara
from os.path import expanduser
import os

print 'yara loaded...'
home = expanduser("~")
rules_path = os.path.join(home, 'tools/rules')
mal_dir = os.path.join(home, 'taasera_malware_repository')
date_str = '2015-08-09'



rules_basic = yara.load(home+'/rules_basic')
rules_malware = yara.load(home+'/rules_malware')


for item in os.listdir(os.path.join(mal_dir, date_str)):
	item_path = os.path.join(mal_dir, date_str+'/'+item)
	matches1 = rules_basic.match(item_path)
	matches2 = rules_malware.match(item_path)
	print item[:32],'#'*70
	print 'basic','-'*20
	print matches1
	print 'malware','-'*20
	print matches2





