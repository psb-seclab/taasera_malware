{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block body_block %}




<div class="container-fluid">
    <div class="row-fluid">
      <div class="span12">
        <div class="well sidebar-nav">
            <li class="nav-header">Filters</li>

            <form class="form-inline" method="post" action="/malware/">
                {% csrf_token %}
            <table>
                <tr>
                    <td width='10%'><p class="navbar-text">File Type</p></td>
                    <td >

                        <label class="radio-inline">
                        {%ifequal "" ftype_pick%}
                        <input type="radio" name="file_type" value="" checked>All</input>
                        {%endifequal%}
                        {%ifnotequal "" ftype_pick%}
                        <input type="radio" name="file_type" value="" >All</input>
                        {%endifnotequal%}
                        </label>

                        {% if ftype_list %}
                        {% for ftype in ftype_list %}
                        <label class="radio-inline">

                            {% if ftype == ftype_pick %}
                                <input type="radio" name="file_type" value="{{ftype}}" checked>{{ftype}}</input>
                            {%else%}
                                <input type="radio" name="file_type" value="{{ftype}}" >{{ftype}}</input>
                            {% endif %}
                        </label>

                        {% endfor %}
                        {% endif %}

                            
                    </td>
                </tr>

                <tr>
                    <td><p class="navbar-text">Honeypot</p></td>
                    <td>
                        
                        <label class="radio-inline">
                        {%ifequal "" honeypot_pick%}
                        <input type="radio" name="honeypot" value="" checked>All</input>
                        {%endifequal%}
                        {%ifnotequal "" honeypot_pick%}
                        <input type="radio" name="honeypot" value="" >All</input>
                        {%endifnotequal%}
                        </label>


                        {% if honeypot_list %}
                        {% for honeypot in honeypot_list %}
                        <label class="radio-inline">

                            {% if honeypot == honeypot_pick %}
                                <input type="radio" name="honeypot" value="{{honeypot}}" checked>{{honeypot}}</input>
                            {%else%}
                                <input type="radio" name="honeypot" value="{{honeypot}}" >{{honeypot}}</input>
                            {% endif %}
                        </label>

                        {% endfor %}
                        {% endif %}




                    </td>
                </tr>

                <tr>
                    <td width='10%'><p class="navbar-text">Date Added</p></td>
                    <td width='40%'>
                        {%if date_pick %}
                        <input type="text" class="form-control"  name='date_added' value="{{date_pick}}">
                        {%else%}
                        <input type="text" class="form-control" placeholder="YYYY-MM-DD" name='date_added' >
                        {% endif %}
                            
                    </td>
                </tr>
                <tr>
                    <td><p class="navbar-text">New Sample</p></td>
                    <td>

                        <label class="radio-inline">
                        {%ifequal "" isnew_pick%}
                        <input type="radio" name="is_new" value="" checked>All</input>
                        {%endifequal%}
                        {%ifnotequal "" isnew_pick%}
                        <input type="radio" name="is_new" value="" >All</input>
                        {%endifnotequal%}
                        </label>

                        <label class="radio-inline">
                        {% if isnew_pick == "True"%}    
                        <input type="radio" name="is_new" value="True" checked>Yes</input>
                        {%else%}
                        <input type="radio" name="is_new" value="True">Yes</input>
                        {% endif %}
                        </label>
                        <label class="radio-inline">
                        {%if isnew_pick == "False" %}
                        <input type="radio" name="is_new" value="False" checked>No</input>
                        
                        {%else%}
                        <input type="radio" name="is_new" value="False">No</input>
                        {% endif %}
                        </label>
                    </td>
                </tr>

                
                        
            </table>
            <p>Number of samples: {{ num_samples }}

            </p>
            <button type="submit" class="btn btn-default">Update list</button>
            {% if ftype_pick or isnew_pick or honeypot_pick or date_pick or status_pick%}
            <button type="submit" name="clear" class="btn btn-default">Clear All</button>
            <button type="submit" name="download" class="btn btn-default">Download</button>
            {%endif%}

            {% if msg_down %}
            {{msg_down}}
            {%endif%}
            </form>



            <li class="nav-header">Search by md5</li>
            <form class="form-inline" role="search" method="post" action="/malware/">
            {% csrf_token %}
            <input type="text" name="md5_val" class="form-control" placeholder="Enter MD5 here"> 
            <button type="submit" class="btn btn-primary">Go!</button>
            </form>


        </div>
      </div>


    </div>
    <!--/row-->
</div>
<!--/.fluid-container-->



<div class="row-fluid">
    <table class="table table-striped">
    <thead>
    <tr>
        <th>MD5</th>
        <th>Date Added</th>
        <th>Size</th>
        <th>Type</th>
        <th>Source</th>
        <th>Cuckoo Report</th>
        <th>VirusTotal Report</th>
        <th>Download</th>

    </tr>   
    </thead>

    <tbody>
    {% if samples %}
    {% for item in samples %}
    <tr>
        <td><a href="/malware/detail/{{item.md5}}" target='blank'>{{item.md5}}</a></td>
        <td>{{item.date_added}}</td>
        <td>{{item.file_size|filesizeformat}}</td>
        <td>{{item.file_type}}</td>
        
        <td>{{item.honeypot}}</td>
        <td>NA</td>

        {% if item.virustotal_link|length > 0 %}
            <td><a href="{{item.virustotal_link}}" target='blank'>VirusTotal Report</a></td>
        {% else %}
            <td>Not Available</td>
        {% endif %}

        <td><a href="{{item.md5}}">download</a></td>
        
    </tr>
    {% endfor %}

    {% endif %}
    </tbody>
    </table>
    {% if not_found %}
    <p> {{not_found}}</p>
    {% else %}
    <div class="pagination">
        <span class="step-links">
            {% if samples.has_previous %}
                <a href="?page={{ samples.previous_page_number }}{{trailer}}">previous</a>
            {% endif %}

            <span class="current">
                Page {{ samples.number }} of {{ samples.paginator.num_pages }}.
            </span>

            {% if samples.has_next %}
                <a href="?page={{ samples.next_page_number }}{{trailer}}">next</a>
            {% endif %}
        </span>
    </div>    
    {% endif %}


</div>

<!--/row-->
{% endblock %}
